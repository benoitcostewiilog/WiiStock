{% extends 'layout.html.twig' %}

{% block title %}Livraison{% endblock %}

{% block page_content %}
<h1>Livraison n°{{ livraison.numero }}</h1>


<div class="row">
    <div class="col-4">
        <p>Statut: {{ livraison.statut.nom }}</p>
        <p>Numéro: {{livraison.numero}}</p>
        <p>Opérateur: {# {{livraison.utilisateur ? livraison.utilisateur.username : "null" }}#}</p>
    </div>
    <div class="col-4">
        <p>Date de commande:
            {{ livraison.demande.date ? livraison.demande.0.date|date('Y-m-d H:i:s') : 'null' }} </p>
        <p>Date attendu:
            {{ livraison.demande.0.dateAttendu ? livraison.demande.0.dateAttendu|date('Y-m-d H:i:s') : 'null' }} </p>
        <p><a href={{path('createLivraison', {'id': livraison.demande.0.id})}}>Aller vers la livraison</a></p>
    </div>
</div>

<table id="table_id" class="table table-striped table-bordered" style="width:100%">
        <thead>
        <tr>
            <th>Nom</th>
            <th>Statut</th>
            <th>Conformité</th>
            <th>Reférences Articles</th>
            <th>position</th>
            <th>destination</th>
            <th>Quantite</th>
            <th>actions</th>
        </tr>
    </thead>
    <tbody>
        {% for row in livraison.demande %}
        {% for article in row.articles %}
        <tr>
            <td>{{ article.nom }}</td>
            <td>{{ article.statut.nom }}</td>
            <td>{{ article.etat ? 'oui' : article.commentaire }}</td>
            <td>{{ article.refArticle.reference }}</td>
            <td>{{ article.position }}</td>
            <td>{{ article.direction }}</td>
            <td>{{ article.quantite }}</td>
            <td>
                <a href="{{ path('articles_show', {'id': article.id}) }}" class="btn btn-xs btn-default command-edit"><i
                        class="fas fa-eye fa-2x"></i></a>
                <a href="{{ path('articles_edit', {'id': article.id}) }}" class="btn btn-xs btn-default command-edit"><i
                        class="fas fa-pencil-alt fa-2x"></i></a>
                {% if article.statut.nom == 2 %}
                <a href={{path('articles_index', {'statut': 'mis en stock',  'id': article.id})}}
                    class="btn btn-xs btn-default command-edit backgreen"><i class="fas fa-check fa-2x"></i></a>
                {% endif %}
            </td>
        </tr>
        {% else %}
        <tr>
            <td colspan="10">aucun résultat</td>
        </tr>
        {% endfor %}
        {% endfor %}
    </tbody>
</table>

<a href={{ path('livraison_index') }} class='button pull-left btn-left'>retour</a>

{{ include('livraison/_delete_form.html.twig') }}
{% endblock %}
{% block javascript %}
<script>
    $(document).ready(function () {
        $('#table_id').DataTable({
            "language": {
                "url": "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/French.json"
            },
        });
    });
</script>

{% endblock %}