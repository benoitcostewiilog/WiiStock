<div class="row align-items-center datatable-header">
    <div class="col-auto">
        <h1 class="my-0"><span>Préparation n°{{ preparation.numero }}</span></h1>
    </div>
    <div class="col-auto ml-auto">
        <div class="btn-group">
            <button type="button"
                    class="btn btn-primary btn-ripple dropdown-toggle dropdown-toggle-split"
                    data-toggle="dropdown"
                    aria-haspopup="true"
                    aria-expanded="false">
                <span class="fa fa-angle-down"></span>
            </button>
            <div class="dropdown-menu dropdown-menu-right pointer">
                {% if isPrepaEditable %}
                    <button hidden id="btnFinishPrepa" data-toggle="modal" data-target="#modalSubmitPreparation"></button>
                    {% if hasRight(constant('App\\Entity\\Menu::ORDRE'), constant('App\\Entity\\Action::EDIT')) %}
                        <a class="dropdown-item" onclick="finishPrepa()">
                            <i class="fa fa-check mr-2"></i>Finir la préparation
                        </a>
                    {% endif %}
                    {% if hasRight(constant('App\\Entity\\Menu::ORDRE'), constant('App\\Entity\\Action::DELETE')) %}
                        <a class="dropdown-item" href=""
                           data-target='#modalDeletePreparation'
                           data-toggle='modal'>
                            <i class="fa fa-trash mr-2"></i>Supprimer
                        </a>
                    {% endif %}
                {% endif %}
                <button onclick="printPrepaBarCodes()" class="dropdown-item pointer">
                    <i class='fas fa-print'></i> Imprimer les étiquettes
                </button>
                {% if hasRight(constant('App\\Entity\\Menu::DEM'), constant('App\\Entity\\Action::DISPLAY_DEM_LIVR')) %}
                    {% if demande %}
                        <a href="{{ path('demande_show', {'id': demande.id}) }}"
                           class="dropdown-item"><i class="mr-2 fas fa-external-link-alt"></i>Retourner à la demande de livraison
                        </a>
                    {% endif %}
                {% endif %}
                {% if hasRight(constant('App\\Entity\\Menu::ORDRE'), constant('App\\Entity\\Action::DISPLAY_ORDRE_LIVR')) %}
                    {% if livraison is not empty %}
                        <a href="{{ path('livraison_show', {'id': livraison.id}) }}"
                           class="dropdown-item"><i class="mr-2 fas fa-external-link-alt"></i>Aller vers l'ordre de livraison</a>
                    {% endif %}
                {% endif %}
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-4">
        <p><strong> Numéro : </strong> {{ preparation.numero }}</p>
        <p id="statutPreparation"><strong> Statut :</strong> {{ preparation.statut ? preparation.statut.nom : '' }}</p>
        <p><strong> Point de livraison :</strong> {{ demande ? demande.destination.label : '' }}</p>
    </div>
    <div class="col-4">
        <p><strong> Opérateur : </strong> {{ preparation.utilisateur ? preparation.utilisateur.username : '' }}</p>
        <p><strong> Demandeur : </strong> {{ demande ? (demande.utilisateur ? demande.utilisateur.username : '') : '' }}</p>
    </div>
    <div class="col-12">
        <p><strong> Commentaire : </strong></p>
        <div class="commentOverflow">
            <p>{{ preparation.commentaire|raw }}</p>
        </div>
    </div>
</div>
