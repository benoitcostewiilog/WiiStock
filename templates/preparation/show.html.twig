{% extends 'layout.html.twig' %}

{% block title %}Préparation{% endblock %}

{% block page_content %}
<h1>Préparation</h1>
<div class="row">
    <div class="col-4">
        <p>Statut: {{ preparation.statut.nom }}</p>
        <p>Numéro: {{ preparation.numero }}</p>
        <p>Opérateur: </p>
    </div>
    <div class="col-4">
        <!-- <a href="" data-toggle="modal" data-target="#modalNewArticle" class="btn btn-primary ml-auto">
            Ajouter un article</a> -->
        {% if finished %}
            <a href="{{path('livraison_new', {'id': preparation.id}) }}" class="btn btn-primary ml-auto">Valider</a>
        {% elseif preparation.livraisons is not empty %}
        <a href="{{path('livraison_show', {'id': preparation.livraisons.0.id})}}"class="btn btn-primary ml-auto">Aller vers la livraison</a>
        {% endif %}
    </div>
</div>
<div class="row">
    {#{% for refArticle in preparation.demandes.0.ligneArticle %}
    <div class="col-2">
        <p>{{refArticle.reference.libelle}}: {{refArticle.quantite}}</p>
    </div>
    {% endfor %}#}
</div>

<table id="tableArticle_id" class="table table-striped table-bordered w-100">

    <thead>
        <tr>
            <th>Référence CEA</th>
            <th>Libellé</th>
            <th>Quantité</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>

    </tbody>
</table>

<a href="{{ path('preparation_index') }}" class="btn">Retour à la liste</a>

{% include 'preparation/modalDeleteArticle.html.twig' %}
{% include 'preparation/modalNewArticle.html.twig' %}

{% endblock %}

{% block javascript %}
<script>
    let id = {{  preparation.demandes is not empty ? preparation.demandes.0.id : 0 }};
</script>
<script src="{{asset('js/preparation.js')}}"></script>

{% endblock %}