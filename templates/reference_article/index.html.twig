{% extends 'layout.html.twig' %}

{% block title %}Référentiel / Articles de référence{% endblock %}

{% block page_content %}
    <h1>
        {% if isCurrentClient(constant('App\\Service\\SpecificService::CLIENT_CEA_LETI')) %}
            Référence CEA
        {% else %}
            Référence
        {% endif %}
    </h1>

    <div id="alerts">
        <div class="alert alert-danger text-center d-none">
            <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
            <span class="error-msg"></span>
        </div>
    </div>

    <div class='d-flex justify-content-end'>
        <div class="dropleft">
            <div class="btn btn-primary dropdown-toggle" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="fas fa-cog"></i>
            </div>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <a class="dropdown-item" data-toggle="modal" data-target="#modalColumnVisible" href="#">Modifier colonnes</a>
                <a class="dropdown-item" data-toggle="modal" data-target="#modalRapidSearch" href="#">Recherche rapide</a>
                <div class="statut dropdown-item" >
                    Références actives seulement
                    <label class="switch">
                        <input class="checkbox" type="checkbox" {{ wantInactif == false ? 'checked' : '' }} onchange="displayActifOrInactif($(this))">
                        <span class="slider round"></span>
                    </label>
                </div>
            </div>
        </div>
        {% if hasRight(constant('App\\Entity\\Menu::STOCK'), constant('App\\Entity\\Action::CREATE')) %}
        <div data-toggle="modal" data-target="#modalNewRefArticle" class="btn btn-action btn-primary"
                   onclick='initNewReferenceArticleEditor("#modalNewRefArticle")'>
            <i class="fa fa-plus mr-2"></i>Nouvel article de référence
        </div>
        {% endif %}
            <div data-toggle="modal" id="printTag" class="printButton {{ filters | length > 0 ? '' : 'btn-disabled' }} btn btn-action btn-primary"
                 onclick="printReferenceArticleBarCode()">
                <i class="fas fa-print"></i> Imprimer les étiquettes
            </div>
    </div>
    <div class="row">
        <div class="col-1">
            <div class="btn btn-primary border-radius-light" data-toggle="modal" data-target="#modalNewFilter">
                <i class="fas fa-filter mr-2"></i>ajouter un filtre
            </div>

            <div id="filters">
                {% for filter in filters %}
                    {% include 'reference_article/oneFilter.html.twig' %}
                {% endfor %}
            </div>
        </div>
        <div class="col-11">
            <div class="d-flex justify-content-center" id="spinner">
                <div class="spinner-border sizeLoader" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
            </div>
            <div class="mr-3">
                <table id="tableRefArticle_id" class="table table-striped table-bordered nowrap w-100 mr-3">
                </table>
            </div>
        </div>
    </div>

    {% include "reference_article/modalDeleteRefArticle.html.twig" %}
    {% include "reference_article/modalEditRefArticle.html.twig" %}
    {% include "reference_article/modalNewRefArticle.html.twig" %}
    {% include "reference_article/modalShowRefArticle.html.twig" %}
    {% include "reference_article/modalNewFilter.html.twig" %}

    {% include "reference_article/modalColumnVisible.html.twig" %}
    {% include "reference_article/modalRapidSearch.html.twig" %}
    {% include "reference_article/modalPlusDemande.html.twig" %}
    {% include "reference_article/modalConfirmDeleteBox.html.twig" %}

    {% include "reference_article/modalShowMouvements.html.twig" %}
    {% include "reference_article/modalCannotDelete.html.twig" %}
    <button id="cannotDelete" hidden data-toggle="modal" data-target="#modalCannotDelete"></button>
    <div hidden id="barcodes"></div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src = "{{ asset('js/form-reference-article.js') }}?{{ date().timestamp }}"></script>
    <script src = "{{ asset('js/referenceArticle.js') }}?{{ date().timestamp }}"></script>
{% endblock %}
