<form method="" class="modal fade" id="modalNewRefArticle" role="dialog" aria-labelledby="dataModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog  modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Créer un article de référence</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body modal-input container-fluid">
                <div class="row">
                    <div class="form-group col-6">
                        <label for="reference">Référence*</label>
                        <input class="form-control data needed" type="text" name="reference" id="reference" maxlength="21">
                    </div>
                    <div class="form-group col-6">
                        <label for="libelle">Nom*</label>
                        <input class="form-control data needed" type="text" name="libelle" id="libelle">
                    </div>
                </div>

                <div class="row">
                    <div class="form-group col-6">
                        <div class="input-group radio-btn">
                            <label for="statut" class="mtb-auto mr-2">Statut</label>
                            <div>
                                <span class="btn active" data-toggle="statut"
                                      data-title="{{ constant('App\\Entity\\ReferenceArticle::STATUT_ACTIF') }}"
                                      onclick="toggleRadioButton($(this))">
                                    {{ constant('App\\Entity\\ReferenceArticle::STATUT_ACTIF') }}
                                </span><span class="btn not-active" data-toggle="statut"
                                             data-title="{{ constant('App\\Entity\\ReferenceArticle::STATUT_INACTIF') }}"
                                             onclick="toggleRadioButton($(this))">
                                    {{ constant('App\\Entity\\ReferenceArticle::STATUT_INACTIF') }}
                                </span>
                            </div>
                            <input type="hidden" name="statut" id="statut" class="data" value="{{ constant('App\\Entity\\ReferenceArticle::STATUT_ACTIF') }}">
                        </div>
                    </div>
                </div>

                <div class="row">
                    {% include 'reference_article/fournisseurArticle.html.twig' %}
                    <div class="form-group col-1">
                        <span class="btn btn-primary" id="addFournisseur"><i class="fa fa-plus"></i></span>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-4">
                        <label for="type">Type*</label>
                        <select name="type" onclick="typeChoice($(this), '-new', $('#typeContentNew'))"
                            onchange="toggleRequiredChampsLibres($(this),'create')"
                            class="form-control data d-block type needed" id="">
                            <option value="">Type à choisir...</option>
                            {% for type in types %}
                            <option value="{{type.id}}">{{type.label}}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group col-4">
                        <label for="categorie">Catégorie d'inventaire</label>
                        <select name="categorie" class="form-control data">
                            {% for categorie in categories %}
                                <option value="{{ categorie.id }}">{{ categorie.label }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="row mb-4">
                    <div class="form-group col-12">
                        <div>
                            <label>Nomenclature</label>
                            <input id='commentaire' class="form-control data" name="commentaire" type="hidden" value=''>
                            <div class="editor-container-new" value=""></div>
                        </div>
                    </div>
                </div>
                <div class="row mt-10 mb-4">
                    <div class="form-group col-4">
                        <div class="input-group radio-btn">
                            <label for="statut" class="mtb-auto mr-2">Gestion quantité</label>
                            <div onclick="updateQuantityDisplay($(this))">
                                <span class="btn active" data-toggle="type_quantite" data-title="reference"
                                    onclick="toggleRequiredChampsFixes($(this)), toggleRadioButton($(this)) ">Par
                                    référence</span><span class="btn not-active" data-toggle="type_quantite"
                                    data-title="article"
                                    onclick="toggleRequiredChampsFixes($(this)), toggleRadioButton($(this))">Par
                                    article</span>
                            </div>
                            <input type="hidden" name="type_quantite" class="data" value="reference" id="type_quantite">

                        </div>
                    </div>
                    <div class="form-group col-3">

                        <div class="reference">
                            <label for="quantite">Quantité*</label>
                            <input class="form-control data needed" type="number" min="0" name="quantite" id="quantite">
                        </div>
                        <div class="article d-none">
                            <label for="quantite">Quantité</label>
                            <input disabled class="form-control" type="number">
                        </div>

                    </div>

                    <div class="form-group col-3">
                        <div class="form-group w-100">
                            <div class="reference">
                                <label for="prix">Prix Unitaire (€)</label>
                                <input class="form-control data" type="number" name="prix" min="0" step="0.01">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="form-group col-6">
                        <div class="input-group reference w-100">
                            <label for="emplacement">Emplacement*</label>
                            <select name="emplacement" id="emplacement"
                                    class="form-control data needed ajax-autocompleteEmplacement">
                            </select>
                        </div>
                    </div>
                </div>

                <!-- CHAMPS LIBRES -->
                <div class="row mt-4">
                    <div class='col-12 mb-2' onclick="visibleBlockModal($(this))">
                        <h3 class='d-flex pointer'>
                            <i class="fas fa-sort-up d-block mr-2"></i>
                            <i class="fas fa-sort-down d-none  mr-2"></i>
                            Champs libres
                        </h3>
                    </div>
                    <div class="form-group col-12 blocVisible d-block" id='typeContentNew'>
                        {% for type in typeChampsLibres %}
                        <div class="d-none" id="{{type.typeId}}-new">
                            <div class="row mt-2">
                                {% for champ in type.champsLibres %}
                                <div class="form-group col-6">
                                    <label>
                                        {{champ.label}}
                                    </label>

                                    {% if champ.typage == 'booleen' %}
                                    {% set checked = (champ.defaultValue == 1) ? 'checked' : '' %}
                                    <label class="switch">
                                        <input type="checkbox" class="data checkbox" {{ checked }} name="{{champ.id}}">
                                        <span class="slider round"></span>
                                    </label>

                                    {% elseif champ.typage == 'number' %}
                                    <input type="number" id="{{champ.id ~ 'create'}}" class="form-control data"
                                        value="{{champ.defaultValue}}" name="{{champ.id}}">

                                    {% elseif champ.typage == 'list' %}
                                    <select id="{{champ.id ~ 'create'}}" class="form-control data" name="{{champ.id}}"
                                        id="input">
                                        <option value="{{champ.defaultValue}}">{{champ.defaultValue}}
                                        </option>
                                        {% for elem in champ.elements %}
                                        {% if champ.defaultValue != elem %}
                                        <option value="{{elem}}">{{elem}}</option>
                                        {% endif %}
                                        {% endfor %}
                                        {% if champ.defaultValue != "" %}
                                        <option value=""></option>
                                        {% endif %}
                                    </select>

                                    {% elseif champ.typage == 'text'  %}
                                    <input id="{{champ.id ~ 'create'}}" class="form-control data" type="text"
                                        value="{{champ.defaultValue}}" name='{{ champ.id }}'>

                                    {% elseif champ.typage == 'date' %}
                                    <input type="date" name="{{ champ.id }}" id="{{champ.id ~ 'create'}}"
                                        class="form-control data" value="{{champ.defaultValue}}">

                                    {% else %}
                                    <input disabled>

                                    {% endif %}
                                </div>
                                {% endfor %}
                            </div>

                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <div class="error-msg p-4"></div>
            <div class="modal-footer">
                <button type="button" class="btn" data-dismiss="modal">Annuler</button>
                <div id="submitNewRefArticle" class="btn btn-primary btn-success" onclick="setCommentaire('.editor-container-new')">
                    Enregistrer</div>
            </div>
        </div>
    </div>
</form>