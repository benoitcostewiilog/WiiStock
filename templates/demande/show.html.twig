{% extends 'layout.html.twig' %}
{% block title %}Demande{% endblock %}
{% block page_content %}

    <h1>Demande de livraison</h1>

    <div class="row">
        <div class="zone-entete col-6 row">
            {% include "demande/enteteDemandeLivraison.html.twig" %}
        </div>

        <div class="col-3 offset-3">
            {% if modifiable %}
                <div class="row justify-content-between">
                    <a href="{{path('finish_demande', {'id': demande.id})}}" class="btn btn-primary btn-action ml-auto">
                        Valider</a>
                </div>
                <div class="row justify-content-between">
                    <a href="" data-id='{{ demande.id }}' data-target='#modalEditDemande' data-toggle='modal'
                       class="btn btn-primary btn-action ml-auto" onclick='initNewLivraisonEditor("#modalEditDemande")'>
                        Modifier</a>
                </div>
                <div class="row justify-content-between">
                    <a href="" data-id='{{ demande.id }}' data-target='#modalDeleteDemande' data-toggle='modal' class="btn btn-danger btn-action ml-auto">
                        Supprimer</a>
                </div>
                <div class="row justify-content-between">
                    <a href="" data-toggle="modal" data-target="#modalNewArticle" class="btn btn-primary btn-action ml-auto">
                        <span class="fa fa-plus mr-2"></span>Ajouter article</a>
                </div>
            {% elseif demande.preparation is not empty %}
                <a href="{{path('preparation_show', {'id': demande.preparation.id }) }}">
                    Aller vers la préparation
                </a>
            {% endif %}
        </div>
    </div>
    <span id="demande-id" data-id="{{ demande.id }}"></span>

    <table id="table-lignes" data-id="{{ demande.id }}" class="table table-striped table-bordered w-100">
        <thead>
        <tr>
            <th>Référence CEA</th>
            <th>Libellé</th>
            <th>Quantité</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        </tbody>
    </table>

    <a href="{{ path('demande_index') }}" class='btn btn-action'>Retour à la liste</a>


    {% include 'demande/modalDeleteArticle.html.twig' %}
    {% include 'demande/modalDeleteDemande.html.twig' %}
    {% include 'demande/modalNewArticle.html.twig' %}
    {% include 'demande/modalEditDemande.html.twig' %}
    {% include 'demande/modalEditArticle.html.twig' %}

{% endblock %}

{% block javascript %}
<script>
const id = {{ demande.id }}
</script>

<script src="{{ asset('js/demande-livraison.js') }}"></script>
{% endblock %}