{% macro paneItem(icon, title, subtitle, isFirst) %}
    <div class="col-12">
        <div class="p-3 association-pane-item d-flex align-items-center {{ isFirst ? 'first-association-pane-item' }}">
            <span class="wii-icon wii-icon-{{ icon }} mr-2"></span>
            <div class="right-column ml-2">
                <span class="title">{{ title }}</span>
                {% if subtitle ?? null %}
                    <span class="subtitle">{{ subtitle | join('<br>') | raw }}</span>
                {% endif %}
            </div>
        </div>
    </div>
{% endmacro %}

{% import _self as macros %}

{% set type = type is defined ? type %}
{% set activeAssociation = activeAssociation is defined ? activeAssociation %}
{% set pairing = pairing is defined ? pairing %}
{% set isTimeline = isTimeline is defined ? isTimeline %}
{% set icon = icon is defined ? icon %}
{% set title = title is defined ? title %}
{% set subtitle = subtitle is defined ? subtitle %}

{% set isTimelineHeader = (type == constant('App\\Service\\IOT\\DataMonitoringService::TIMELINE')) %}

<div class="row position-relative association-pane-item-container">
    {% if isTimeline %}
        <div class="col-12 timeline-container"
             data-timeline-data-path="{{ timelineDataPath }}">
        </div>
    {% elseif items is defined %}
        {% for item in items %}
            {{ macros.paneItem(item.icon, item.title, item.subtitle ?? null, loop.first) }}
        {% endfor %}
    {% else %}
        {{ macros.paneItem(icon, title, subtitle ?? null, true) }}
    {% endif %}

    {% if type == 'sensor'
          or type == 'entity' %}
        <div class="dropdown dropleft association-actions">
            <img src="{{ asset('svg/dotsblack.svg') }}"
                 alt="Actions"
                 height="20px"
                 width="8px"
                 data-toggle="dropdown" class="pointer"/>
            <div class="dropdown-menu dropdown-follow-gt pointer">
                {% if type == 'sensor' and pairing %}
                    <button class="dropdown-item pointer" data-toggle="modal" data-target="#modalEditPairingEnd" data-id="{{ pairing.id }}">
                        <i class="fas fa-edit"></i> Modifier fin association
                    </button>
                    <button class="dropdown-item pointer" onclick="unpair({{ pairing.id }})"><i class="fas fa-unlink"></i> Dissocier</button>
                {% elseif type == 'entity' %}
                    <button class="dropdown-item pointer"><i class="fas fa-wifi"></i> Voir l'historique des donn√©es</button>
                {% endif %}
            </div>
        </div>
    {% endif %}
</div>
